==========================================
COMPLETE KERNEL BENCHMARK ON H100
==========================================
Building standalone benchmark with actual kernel launch

üì¶ Uploading complete benchmark...
‚úÖ Uploaded

+ cd /workspace/benchmark_complete
+ export PATH=/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
+ PATH=/usr/local/cuda/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
+ export LD_LIBRARY_PATH=/usr/local/cuda/lib64:
+ LD_LIBRARY_PATH=/usr/local/cuda/lib64:
+ echo ==========================================
==========================================
STEP 1: COMPILE COMPLETE BENCHMARK
==========================================
+ echo 'STEP 1: COMPILE COMPLETE BENCHMARK'
+ echo ==========================================
+ nvcc -std=c++17 -O3 -Xptxas -O3 --use_fast_math -gencode arch=compute_90,code=sm_90 attention_benchmark.cu -o attention_benchmark
‚úÖ Compiled executable
+ echo '‚úÖ Compiled executable'
+ ls -lh attention_benchmark
-rwxr-xr-x 1 root root 1003K Oct 25 16:56 attention_benchmark

==========================================
STEP 2: EXTRACT AND VALIDATE KERNEL SASS
==========================================
+ echo ''
+ echo ==========================================
+ echo 'STEP 2: EXTRACT AND VALIDATE KERNEL SASS'
+ echo ==========================================
+ cuobjdump -sass attention_benchmark
Predicated branches: 11
Register spills: 0
0
++ grep -cP '@P\d+\s+BRA' sass_complete.txt
+ BRANCH_COUNT=11
+ echo 'Predicated branches: 11'
++ grep -cP '\b(LD|ST)\.LCL' sass_complete.txt
++ echo 0
+ SPILL_COUNT='0
0'
+ echo 'Register spills: 0
0'
++ grep -c '\.shared\.' sass_complete.txt
++ echo 0
Shared memory instructions: 0
0

==========================================
STEP 3: RUN KERNEL BENCHMARK
==========================================
+ SMEM_COUNT='0
0'
+ echo 'Shared memory instructions: 0
0'
+ echo ''
+ echo ==========================================
+ echo 'STEP 3: RUN KERNEL BENCHMARK'
+ echo ==========================================
+ ./attention_benchmark
+ tee benchmark_output.txt
========================================
Attention Kernel Benchmark
========================================
Configuration: B=1, H=8, S=512, D=64
Device: NVIDIA H100 80GB HBM3
Compute Capability: 9.0

Running benchmark (warmup=100, iters=1000)...

Custom Kernel Performance (Device-Time):
  Min:    40518.59 Œºs
  Median: 40541.06 Œºs
  p99:    40560.80 Œºs
  Max:    40594.46 Œºs

========================================
Benchmark Complete
========================================
Results saved to: kernel_performance.txt

==========================================
STEP 4: COMPARE VS PYTORCH SDPA
==========================================
+ echo ''
+ echo ==========================================
+ echo 'STEP 4: COMPARE VS PYTORCH SDPA'
+ echo ==========================================
+ python3

PyTorch SDPA:
  Median:   23.52 Œºs
  p99:      28.16 Œºs

==========================================
RESULTS COMPARISON
==========================================
Our Kernel:
+ echo ''
+ echo ==========================================
+ echo 'RESULTS COMPARISON'
+ echo ==========================================
+ echo 'Our Kernel:'
+ cat kernel_performance.txt
KERNEL_MEDIAN_US=40541.06
KERNEL_P99_US=40560.80

PyTorch SDPA:
SDPA_MEDIAN_US=23.52
SDPA_P99_US=28.16

+ echo ''
+ echo 'PyTorch SDPA:'
+ cat sdpa_performance.txt
+ echo ''
+ python3
========================================
SPEEDUP ANALYSIS
========================================
PyTorch SDPA:      23.52 Œºs (baseline)
Our Kernel:      40541.06 Œºs
Speedup:         0.00√ó

Target (5√ó):        4.70 Œºs
Status:          ‚ö†Ô∏è  SLOWER (needs optimization)
Gap:             1723.68√ó slower
SDPA_MEDIAN_US=23.52
KERNEL_MEDIAN_US=40541.06
SPEEDUP=0.00
TARGET_5X_US=4.70
STATUS=SLOWER
+ cat speedup_results.txt
+ exit 0

‚¨áÔ∏è  Downloading results...

==========================================
FINAL RESULTS
==========================================
SDPA_MEDIAN_US=23.52
KERNEL_MEDIAN_US=40541.06
SPEEDUP=0.00
TARGET_5X_US=4.70
STATUS=SLOWER

‚úÖ Complete benchmark finished
Results saved to: speedup_results.txt
